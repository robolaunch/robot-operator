apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: robotartifacts.robot.roboscale.io
  annotations:
    controller-gen.kubebuilder.io/version: v0.9.2
  labels:
  {{- include "robot-operator.labels" . | nindent 4 }}
spec:
  group: robot.roboscale.io
  names:
    kind: RobotArtifact
    listKind: RobotArtifactList
    plural: robotartifacts
    singular: robotartifact
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: RobotArtifact is a non-functional resource that holds Robot's specifications.
          It is used to define Robot templates.
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          template:
            description: Holds Robot's `.spec`.
            properties:
              buildManagerTemplate:
                description: '[*alpha*] Build manager template for initial configuration.'
                properties:
                  steps:
                    description: Defines the building steps.
                    items:
                      description: Step is a command or script to execute when building
                        a robot. Either `command` or `script` should be specified for
                        each step.
                      properties:
                        command:
                          description: Bash command to run. Assume that your command
                            will be `/bin/bash -c <COMMAND>`. Use logical operators
                            (eg. `&&`) and pipes if the multiple dependent commands
                            will be executed.
                          type: string
                        env:
                          description: Environment variables for step.
                          items:
                            description: EnvVar represents an environment variable present
                              in a Container.
                            properties:
                              name:
                                description: Name of the environment variable. Must
                                  be a C_IDENTIFIER.
                                type: string
                              value:
                                description: 'Variable references $(VAR_NAME) are expanded
                                  using the previously defined environment variables
                                  in the container and any service environment variables.
                                  If a variable cannot be resolved, the reference in
                                  the input string will be unchanged. Double $$ are
                                  reduced to a single $, which allows for escaping the
                                  $(VAR_NAME) syntax: i.e. "$$(VAR_NAME)" will produce
                                  the string literal "$(VAR_NAME)". Escaped references
                                  will never be expanded, regardless of whether the
                                  variable exists or not. Defaults to "".'
                                type: string
                              valueFrom:
                                description: Source for the environment variable's value.
                                  Cannot be used if value is not empty.
                                properties:
                                  configMapKeyRef:
                                    description: Selects a key of a ConfigMap.
                                    properties:
                                      key:
                                        description: The key to select.
                                        type: string
                                      name:
                                        description: 'Name of the referent. More info:
                                          https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                                          TODO: Add other useful fields. apiVersion,
                                          kind, uid?'
                                        type: string
                                      optional:
                                        description: Specify whether the ConfigMap or
                                          its key must be defined
                                        type: boolean
                                    required:
                                    - key
                                    type: object
                                    x-kubernetes-map-type: atomic
                                  fieldRef:
                                    description: 'Selects a field of the pod: supports
                                      metadata.name, metadata.namespace, `metadata.labels[''<KEY>'']`,
                                      `metadata.annotations[''<KEY>'']`, spec.nodeName,
                                      spec.serviceAccountName, status.hostIP, status.podIP,
                                      status.podIPs.'
                                    properties:
                                      apiVersion:
                                        description: Version of the schema the FieldPath
                                          is written in terms of, defaults to "v1".
                                        type: string
                                      fieldPath:
                                        description: Path of the field to select in
                                          the specified API version.
                                        type: string
                                    required:
                                    - fieldPath
                                    type: object
                                    x-kubernetes-map-type: atomic
                                  resourceFieldRef:
                                    description: 'Selects a resource of the container:
                                      only resources limits and requests (limits.cpu,
                                      limits.memory, limits.ephemeral-storage, requests.cpu,
                                      requests.memory and requests.ephemeral-storage)
                                      are currently supported.'
                                    properties:
                                      containerName:
                                        description: 'Container name: required for volumes,
                                          optional for env vars'
                                        type: string
                                      divisor:
                                        anyOf:
                                        - type: integer
                                        - type: string
                                        description: Specifies the output format of
                                          the exposed resources, defaults to "1"
                                        pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                                        x-kubernetes-int-or-string: true
                                      resource:
                                        description: 'Required: resource to select'
                                        type: string
                                    required:
                                    - resource
                                    type: object
                                    x-kubernetes-map-type: atomic
                                  secretKeyRef:
                                    description: Selects a key of a secret in the pod's
                                      namespace
                                    properties:
                                      key:
                                        description: The key of the secret to select
                                          from.  Must be a valid secret key.
                                        type: string
                                      name:
                                        description: 'Name of the referent. More info:
                                          https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                                          TODO: Add other useful fields. apiVersion,
                                          kind, uid?'
                                        type: string
                                      optional:
                                        description: Specify whether the Secret or its
                                          key must be defined
                                        type: boolean
                                    required:
                                    - key
                                    type: object
                                    x-kubernetes-map-type: atomic
                                type: object
                            required:
                            - name
                            type: object
                          type: array
                        instances:
                          description: Cluster selector. If the current instance name
                            is on the list, BuildManager creates building jobs.
                          items:
                            type: string
                          type: array
                        name:
                          description: Name of the step.
                          type: string
                        script:
                          description: Bash script to run.
                          type: string
                        workspace:
                          description: Name of the workspace. Should be selected among
                            the existing workspaces in WorkspaceManager's manifests.
                          type: string
                      required:
                      - name
                      - workspace
                      type: object
                    type: array
                type: object
              development:
                description: '[*alpha*] Switch to development mode if `true`.'
                type: boolean
              discoveryServerTemplate:
                description: Discovery server configurational parameters.
                properties:
                  cluster:
                    description: Cloud instance name that holds DiscoveryServer instance
                      with `Server` type. Should be empty if the type is `Server` since
                      it takes cloud instance's name automatically. Should be set if
                      the type is `Client`.
                    type: string
                  hostname:
                    description: If instance type is `Server`, it can be an arbitrary
                      value. If instance type is `Client`, it should be the same with
                      Server's hostname. Used for getting Server's IP over DNS.
                    type: string
                  reference:
                    description: Reference to the `Server` instance. It is used if `.spec.type`
                      is `Client`. Referenced object can be previously provisioned in
                      another cluster. In that case, cluster's name can be specified
                      in `.spec.cluster` field.
                    properties:
                      apiVersion:
                        description: API version of the referent.
                        type: string
                      fieldPath:
                        description: 'If referring to a piece of an object instead of
                          an entire object, this string should contain a valid JSON/Go
                          field access statement, such as desiredState.manifest.containers[2].
                          For example, if the object reference is to a container within
                          a pod, this would take on a value like: "spec.containers{name}"
                          (where "name" refers to the name of the container that triggered
                          the event) or if no container name is specified "spec.containers[2]"
                          (container with index 2 in this pod). This syntax is chosen
                          only to have some well-defined way of referencing a part of
                          an object. TODO: this design is not final and this field is
                          subject to change in the future.'
                        type: string
                      kind:
                        description: 'Kind of the referent. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
                        type: string
                      name:
                        description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names'
                        type: string
                      namespace:
                        description: 'Namespace of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/'
                        type: string
                      resourceVersion:
                        description: 'Specific resourceVersion to which this reference
                          is made, if any. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#concurrency-control-and-consistency'
                        type: string
                      uid:
                        description: 'UID of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#uids'
                        type: string
                    type: object
                    x-kubernetes-map-type: atomic
                  subdomain:
                    description: If instance type is `Server`, it can be an arbitrary
                      value. If instance type is `Client`, it should be the same with
                      Server's subdomain. Used for getting Server's IP over DNS.
                    type: string
                  type:
                    description: Instance type can be either `Server` or `Client`. If
                      `Server`, instance creates discovery server resources and workloads.
                      Other `Client` instances can connect to the `Server` instance.
                      If `Client`, instance tries to connect a `Server` instance and
                      hold `Server` configuration in a ConfigMap.
                    type: string
                type: object
              distributions:
                description: ROS 2 distributions to be used. You can select multiple
                  distributions if they are supported in the same underlying OS. (eg.
                  `foxy` and `galactic` are supported in Ubuntu Focal, so they can be
                  used together but both cannot be used with `humble`)
                items:
                  description: ROS 2 distribution selection. Currently supported distributions
                    are Humble, Foxy, Galactic.
                  enum:
                  - foxy
                  - galactic
                  - humble
                  type: string
                maxItems: 2
                minItems: 1
                type: array
              launchManagerTemplates:
                description: '[*alpha*] Launch manager template for initial configuration.'
                items:
                  description: LaunchManagerSpec defines the desired state of LaunchManager.
                  properties:
                    display:
                      description: Launch processes connects an X11 socket if it's set
                        to `true` and a target RobotVDI resource is set in labels with
                        key `robolaunch.io/target-vdi`. Applications that requires GUI
                        can be executed such as rViz.
                      type: boolean
                    launch:
                      additionalProperties:
                        description: Launch description of a repository.
                        properties:
                          container:
                            description: General container configuration parameters.
                            properties:
                              env:
                                description: Additional environment variables to set
                                  when launching ROS nodes.
                                items:
                                  description: EnvVar represents an environment variable
                                    present in a Container.
                                  properties:
                                    name:
                                      description: Name of the environment variable.
                                        Must be a C_IDENTIFIER.
                                      type: string
                                    value:
                                      description: 'Variable references $(VAR_NAME)
                                        are expanded using the previously defined environment
                                        variables in the container and any service environment
                                        variables. If a variable cannot be resolved,
                                        the reference in the input string will be unchanged.
                                        Double $$ are reduced to a single $, which allows
                                        for escaping the $(VAR_NAME) syntax: i.e. "$$(VAR_NAME)"
                                        will produce the string literal "$(VAR_NAME)".
                                        Escaped references will never be expanded, regardless
                                        of whether the variable exists or not. Defaults
                                        to "".'
                                      type: string
                                    valueFrom:
                                      description: Source for the environment variable's
                                        value. Cannot be used if value is not empty.
                                      properties:
                                        configMapKeyRef:
                                          description: Selects a key of a ConfigMap.
                                          properties:
                                            key:
                                              description: The key to select.
                                              type: string
                                            name:
                                              description: 'Name of the referent. More
                                                info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                                                TODO: Add other useful fields. apiVersion,
                                                kind, uid?'
                                              type: string
                                            optional:
                                              description: Specify whether the ConfigMap
                                                or its key must be defined
                                              type: boolean
                                          required:
                                          - key
                                          type: object
                                          x-kubernetes-map-type: atomic
                                        fieldRef:
                                          description: 'Selects a field of the pod:
                                            supports metadata.name, metadata.namespace,
                                            `metadata.labels[''<KEY>'']`, `metadata.annotations[''<KEY>'']`,
                                            spec.nodeName, spec.serviceAccountName,
                                            status.hostIP, status.podIP, status.podIPs.'
                                          properties:
                                            apiVersion:
                                              description: Version of the schema the
                                                FieldPath is written in terms of, defaults
                                                to "v1".
                                              type: string
                                            fieldPath:
                                              description: Path of the field to select
                                                in the specified API version.
                                              type: string
                                          required:
                                          - fieldPath
                                          type: object
                                          x-kubernetes-map-type: atomic
                                        resourceFieldRef:
                                          description: 'Selects a resource of the container:
                                            only resources limits and requests (limits.cpu,
                                            limits.memory, limits.ephemeral-storage,
                                            requests.cpu, requests.memory and requests.ephemeral-storage)
                                            are currently supported.'
                                          properties:
                                            containerName:
                                              description: 'Container name: required
                                                for volumes, optional for env vars'
                                              type: string
                                            divisor:
                                              anyOf:
                                              - type: integer
                                              - type: string
                                              description: Specifies the output format
                                                of the exposed resources, defaults to
                                                "1"
                                              pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                                              x-kubernetes-int-or-string: true
                                            resource:
                                              description: 'Required: resource to select'
                                              type: string
                                          required:
                                          - resource
                                          type: object
                                          x-kubernetes-map-type: atomic
                                        secretKeyRef:
                                          description: Selects a key of a secret in
                                            the pod's namespace
                                          properties:
                                            key:
                                              description: The key of the secret to
                                                select from.  Must be a valid secret
                                                key.
                                              type: string
                                            name:
                                              description: 'Name of the referent. More
                                                info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                                                TODO: Add other useful fields. apiVersion,
                                                kind, uid?'
                                              type: string
                                            optional:
                                              description: Specify whether the Secret
                                                or its key must be defined
                                              type: boolean
                                          required:
                                          - key
                                          type: object
                                          x-kubernetes-map-type: atomic
                                      type: object
                                  required:
                                  - name
                                  type: object
                                type: array
                              privileged:
                                description: Launch container privilege.
                                type: boolean
                              resources:
                                description: Launch container resource limits.
                                properties:
                                  cpu:
                                    description: CPU resource limit.
                                    pattern: ^([0-9])+(m)$
                                    type: string
                                  gpuCore:
                                    description: GPU core number that will be allocated.
                                    type: integer
                                  memory:
                                    description: Memory resource limit.
                                    pattern: ^([0-9])+(Mi|Gi)$
                                    type: string
                                type: object
                            type: object
                          entrypoint:
                            description: Entrypoint configuration of launch.
                            properties:
                              cmd:
                                description: Custom command to launch packages or start
                                  nodes. Required if the launch type is `Custom`.
                                type: string
                              disableSourcingWs:
                                description: If `true`, workspaces are not sourced by
                                  default. Used if the launch type is `Custom`.
                                type: boolean
                              executable:
                                description: Executable file name. (eg. `webcam_pub.py`)
                                  Required and used if the launch type is `Run`.
                                type: string
                              launchfile:
                                description: Launchfile. (eg. `nav_launch.py`) Required
                                  and used if the launch type is `Launch`.
                                type: string
                              package:
                                description: Package name. (eg. `robolaunch_cloudy_navigation`)
                                type: string
                              parameters:
                                additionalProperties:
                                  type: string
                                description: Launch parameters.
                                type: object
                              prelaunch:
                                description: Command or script to run just before node's
                                  execution.
                                properties:
                                  command:
                                    description: Bash command to run before ROS node
                                      execution.
                                    type: string
                                required:
                                - command
                                type: object
                              type:
                                description: Launching type. Can be `Launch`, `Run`
                                  or `Custom`.
                                enum:
                                - Launch
                                - Run
                                - Custom
                                type: string
                            required:
                            - cmd
                            - disableSourcingWs
                            - executable
                            - launchfile
                            - package
                            type: object
                          instances:
                            description: Cluster selector. If the current instance name
                              is on the list, LaunchManager creates launch pods.
                            items:
                              type: string
                            type: array
                          namespacing:
                            description: ROS 2 namespacing. May not be suitable for
                              all launchfiles. If used, all the node names and topic
                              names should be defined relative, not absolute. (eg. `cmd_vel`
                              instead of /cmd_vel``)
                            type: boolean
                          workspace:
                            description: Name of the workspace. Should be selected among
                              the existing workspaces in WorkspaceManager's manifests.
                            type: string
                        required:
                        - workspace
                        type: object
                      description: Launch descriptions. Every object defined here generates
                        a launching command in the specified workspace.
                      type: object
                  type: object
                type: array
              rmwImplementation:
                default: rmw_fastrtps_cpp
                description: RMW implementation selection. Robot operator currently
                  supports only FastRTPS. See https://docs.ros.org/en/foxy/How-To-Guides/Working-with-multiple-RMW-implementations.html.
                enum:
                - rmw_fastrtps_cpp
                type: string
              robotDevSuiteTemplate:
                description: Robot development suite template
                properties:
                  ideEnabled:
                    description: If `true`, a Cloud IDE will be provisioned inside development
                      suite.
                    type: boolean
                  robotIDETemplate:
                    description: Configurational parameters of RobotIDE. Applied if
                      `.spec.ideEnabled` is set to `true`.
                    properties:
                      display:
                        description: Cloud IDE connects an X11 socket if it's set to
                          `true` and a target RobotVDI resource is set in labels with
                          key `robolaunch.io/target-vdi`. Applications that requires
                          GUI can be executed such as rViz.
                        type: boolean
                      ingress:
                        description: '[*alpha*] RobotIDE will create an Ingress resource
                          if `true`.'
                        type: boolean
                      privileged:
                        description: If `true`, containers of RobotIDE will be privileged
                          containers. It can be used in physical instances where it's
                          necessary to access I/O devices on the host machine. Not recommended
                          to activate this field on cloud instances.
                        type: boolean
                      resources:
                        description: Resource limitations of Cloud IDE.
                        properties:
                          cpu:
                            description: CPU resource limit.
                            pattern: ^([0-9])+(m)$
                            type: string
                          gpuCore:
                            description: GPU core number that will be allocated.
                            type: integer
                          memory:
                            description: Memory resource limit.
                            pattern: ^([0-9])+(Mi|Gi)$
                            type: string
                        type: object
                      serviceType:
                        default: NodePort
                        description: Service type of Cloud IDE. `ClusterIP` and `NodePort`
                          is supported.
                        enum:
                        - ClusterIP
                        - NodePort
                        type: string
                    type: object
                  robotVDITemplate:
                    description: Configurational parameters of RobotVDI. Applied if
                      `.spec.vdiEnabled` is set to `true`.
                    properties:
                      ingress:
                        description: '[*alpha*] RobotIDE will create an Ingress resource
                          if `true`.'
                        type: boolean
                      nat1to1:
                        description: NAT1TO1 option for Cloud VDI.
                        type: string
                      privileged:
                        description: If `true`, containers of RobotIDE will be privileged
                          containers. It can be used in physical instances where it's
                          necessary to access I/O devices on the host machine. Not recommended
                          to activate this field on cloud instances.
                        type: boolean
                      resolution:
                        default: 2048x1152
                        description: VDI screen resolution options. Default is `2048x1152`.
                        enum:
                        - 2048x1152
                        - 1920x1080
                        - 1600x1200
                        type: string
                      resources:
                        description: Resource limitations of Cloud IDE.
                        properties:
                          cpu:
                            description: CPU resource limit.
                            pattern: ^([0-9])+(m)$
                            type: string
                          gpuCore:
                            description: GPU core number that will be allocated.
                            type: integer
                          memory:
                            description: Memory resource limit.
                            pattern: ^([0-9])+(Mi|Gi)$
                            type: string
                        type: object
                      serviceType:
                        default: NodePort
                        description: Service type of Cloud IDE. `ClusterIP` and `NodePort`
                          is supported.
                        enum:
                        - ClusterIP
                        - NodePort
                        type: string
                      webrtcPortRange:
                        description: UDP port range to used in WebRTC connections.
                        pattern: ^([0-9])+-([0-9])+$
                        type: string
                    type: object
                  vdiEnabled:
                    description: If `true`, a Cloud VDI will be provisioned inside development
                      suite.
                    type: boolean
                type: object
              rootDNSConfig:
                description: '[*alpha*] Root DNS configuration.'
                properties:
                  host:
                    description: '[*alpha*] Root DNS name..'
                    type: string
                required:
                - host
                type: object
              rosBridgeTemplate:
                description: ROS bridge configurational parameters.
                properties:
                  ros:
                    description: Configurational parameters for ROS bridge.
                    properties:
                      distro:
                        description: ROS distribution for bridge.
                        enum:
                        - foxy
                        - galactic
                        - humble
                        type: string
                      enabled:
                        description: If `true`, resources and workloads are created
                          by ROSBridge.
                        type: boolean
                    type: object
                  ros2:
                    description: Configurational parameters for ROS 2 bridge.
                    properties:
                      distro:
                        description: ROS distribution for bridge.
                        enum:
                        - foxy
                        - galactic
                        - humble
                        type: string
                      enabled:
                        description: If `true`, resources and workloads are created
                          by ROSBridge.
                        type: boolean
                    type: object
                type: object
              storage:
                description: Total storage amount to persist via Robot. Unit of measurement
                  is MB. (eg. `10240` corresponds 10 GB) This amount is being shared
                  between different components.
                properties:
                  amount:
                    default: 10000
                    description: Specifies how much storage will be allocated in total.
                      Use MB as a unit of measurement. (eg. `10240` is equal to 10 GB)
                    type: integer
                  storageClassConfig:
                    description: Storage class selection for robot's volumes.
                    properties:
                      accessMode:
                        description: PVC access modes. Currently, only `ReadWriteOnce`
                          is supported.
                        type: string
                      name:
                        description: Storage class name.
                        type: string
                    type: object
                type: object
              tlsSecretRef:
                description: '[*alpha*] TLS secret reference.'
                properties:
                  name:
                    description: '[*alpha*] TLS secret object name.'
                    type: string
                  namespace:
                    description: '[*alpha*] TLS secret object namespace.'
                    type: string
                required:
                - name
                - namespace
                type: object
              workspaceManagerTemplate:
                description: Workspace manager template to configure ROS 2 workspaces.
                properties:
                  updateNeeded:
                    description: WorkspaceManager is triggered if this field is set
                      to `true`. Then the workspaces are being configured again while
                      backing up the old configurations. This field is often used by
                      operator.
                    type: boolean
                  workspaces:
                    description: Workspace definitions of robot. Multiple ROS 2 workspaces
                      can be configured over this field.
                    items:
                      description: Workspace description. Each robot should contain
                        at least one workspace. A workspace should contain at least
                        one repository in it.
                      properties:
                        distro:
                          description: ROS 2 distribution selection. Currently supported
                            distributions are Humble, Foxy, Galactic.
                          enum:
                          - foxy
                          - galactic
                          - humble
                          type: string
                        name:
                          description: Name of workspace. If a workspace's name is `my_ws`,
                            it's absolute path is `/home/workspaces/my_ws`.
                          type: string
                        repositories:
                          additionalProperties:
                            description: Repository description.
                            properties:
                              branch:
                                description: Branch of the repository to clone.
                                type: string
                              hash:
                                description: '[*Autofilled*] Hash of last commit'
                                type: string
                              owner:
                                description: '[*Autofilled*] User or organization, maintainer
                                  of repository'
                                type: string
                              path:
                                description: '[*Autofilled*] Absolute path of repository'
                                type: string
                              repo:
                                description: '[*Autofilled*] Repository name'
                                type: string
                              url:
                                description: Base URL of the repository.
                                type: string
                            required:
                            - branch
                            - url
                            type: object
                          description: Repositories to clone inside workspace's `src`
                            directory.
                          type: object
                      required:
                      - distro
                      - name
                      - repositories
                      type: object
                    minItems: 1
                    type: array
                  workspacesPath:
                    description: Global path of workspaces. It's fixed to `/root/workspaces`
                      path.
                    type: string
                type: object
            required:
            - distributions
            - rmwImplementation
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []